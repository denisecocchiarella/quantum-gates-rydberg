(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15656,        356]
NotebookOptionsPosition[     14981,        337]
NotebookOutlinePosition[     15379,        353]
CellTagsIndexPosition[     15336,        350]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PE", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PauliMatrix", "[", "3", "]"}], "+", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"n_", ",", "y_", ",", "\[Xi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", "n", "]"}], "/", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Xi]", "]"}], "*", 
        RowBox[{"PauliMatrix", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Xi]", "]"}], "*", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], ")"}]}], "-", 
    RowBox[{"y", "*", "PE"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U11", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"H", "[", 
      RowBox[{"1", ",", "y1", ",", "\[Xi]1"}], "]"}], "*", "s1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U12", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"H", "[", 
      RowBox[{"1", ",", "y2", ",", "\[Xi]2"}], "]"}], "*", "s2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U13", "=", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "I"}], "*", 
      RowBox[{"H", "[", 
       RowBox[{"1", ",", "y1", ",", "0"}], "]"}], "*", "s3"}], "]"}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U21", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"H", "[", 
      RowBox[{"2", ",", "y1", ",", "\[Xi]1"}], "]"}], "*", "s1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U22", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"H", "[", 
      RowBox[{"2", ",", "y2", ",", "\[Xi]2"}], "]"}], "*", "s2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U23", "=", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "I"}], "*", 
      RowBox[{"H", "[", 
       RowBox[{"2", ",", "y1", ",", "0"}], "]"}], "*", "s3"}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U31", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"H", "[", 
      RowBox[{"3", ",", "y1", ",", "\[Xi]1"}], "]"}], "*", "s1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U32", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"H", "[", 
      RowBox[{"3", ",", "y2", ",", "\[Xi]2"}], "]"}], "*", "s2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U33", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"H", "[", 
      RowBox[{"3", ",", "y1", ",", "0"}], "]"}], "*", "s3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pa", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], " ", "a", " ", "*", "PE"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pb", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], " ", "b", "*", "PE"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", " ", "=", " ", 
   RowBox[{"Pi", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "+", 
      RowBox[{"y1", "^", "2"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzn0s1AEYB/DbabZOSQppfn/odiIirpXukJO3qRG2W0gb3TW0MbVINJfT
uSyRd7qV4iylW0m63FU64czLcl6z8zLMW7fGpiMp/b6/P559tue758U+PiVC
SKfRaN5kQaU6Jzu8zMAbM/eXwtfV5gVwy+xlETxRI5LB8qvEE/jbLb85gnSq
3lMJJwXWn2FzjU07ZKzotNBXvtEDN1vO62FopIDSnC6egSEE2wDrLTj0SFL3
qesmMImraIwlbX17ugmuVaaqoUfIsTaYGX0jM5V0MYaVBUsGrfKgkuBLocTY
PXCL9EHftRF4L7+IlUkqLZE4wiy+zhUSqlQ3GGz7iw31QslxGJrnyoFRtWE+
MF6ceBa6n0kOg4a7zoWQEdz0EMZOSv48ImXuz9qCh0SBVjLS7uJ5yuJeh3T4
ac0jA67MDIqFDQbesjcvFzaLgtqVpDpNFKXpKaEO/lxepTRXVI9Cv2mTMfg1
YE4PtcyTM1BwNMAIi9qW1mGa09LOD6SKRQkDNo6ILWF/gWwf1V9ZtoVjMu5B
yCjjMWH89hgLlr7TBaqwZ5sIgpWVznzYIZyNhQ3Pxkuhgu9UAdeGd9XBmm/l
LfBSDlcFOfyENqiuGx2AUq+QIehpefM7lfOIScjviVuFfeNXjNDUieajJjXQ
91BKLngEwVcTVedgcesbuy+4L/InYO8Wxx5edNMyoXHa6AKjJriusJij5UA/
s39e8LFmyR92Ov4IgDEsdhisoL3gw8Xojstw3rcuEd6RFyZD2/n3lP2sDTHs
2iu7D11S4krgRtUBGbSzuf2Umrc+LIe+Cz0quMN74SO0T2/ahGly7l/q7yPD
DA2pA/u5DQxP8iWgJlJPOWLR2QUTand3wxZa/CzMzsidg9MCkREOrA9R/gdK
miDO
  "],
 CellLabel->
  "In[1542]:=",ExpressionUUID->"dd06cdfb-210f-42cd-8419-0fb063a760b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"c1", ",", 
    RowBox[{"c2", " ", "=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ".", "U11", ".", "Pb", ".", "U12", ".",
       "Pa", ".", "U12", ".", "Pb", ".", "U11", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ".", "U21", ".", "Pb", ".", "U22", ".",
       "Pa", ".", "U22", ".", "Pb", ".", "U21", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c3", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ".", "U31", ".", "Pb", ".", "U32", ".",
       "Pa", ".", "U32", ".", "Pb", ".", "U31", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"FindMinimum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "c1", "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"Abs", "[", "c2", "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"Abs", "[", "c3", "]"}], "^", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
      "y1", ",", "y2", ",", "s2", ",", "\[Xi]1", ",", "\[Xi]2", ",", "a", ",",
        "b"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.836382277225972*^9, 3.836382296639525*^9}, {
   3.83638242018347*^9, 3.836382424007472*^9}, {3.8363847241904716`*^9, 
   3.83638475334127*^9}, {3.83638479491469*^9, 3.836384865956764*^9}, {
   3.8363849810503483`*^9, 3.836385093285791*^9}, {3.836385124084876*^9, 
   3.836385165137939*^9}, {3.836385288747438*^9, 3.836385370319961*^9}, {
   3.83640703691798*^9, 3.8364070448823347`*^9}, {3.836407107493535*^9, 
   3.836407131931945*^9}, {3.8364071686478148`*^9, 3.836407195195702*^9}, {
   3.836447235031152*^9, 3.836447237948675*^9}, {3.83644772221987*^9, 
   3.836447962140441*^9}, {3.836448014059657*^9, 3.836448023519678*^9}, {
   3.8364577143805437`*^9, 3.836457715787431*^9}, {3.8364577691365128`*^9, 
   3.8364577951108027`*^9}, {3.836466809326003*^9, 3.8364668106143103`*^9}, {
   3.8364668722321978`*^9, 3.836466878727311*^9}, {3.8364670991640997`*^9, 
   3.836467123226348*^9}, {3.836467166138999*^9, 3.836467195367255*^9}, {
   3.83646723286329*^9, 3.8364672688048067`*^9}, {3.836467527986186*^9, 
   3.836467557861343*^9}, {3.836467588139728*^9, 3.836467638469461*^9}, {
   3.836467678662079*^9, 3.836467715499939*^9}, {3.836467768053926*^9, 
   3.8364679891766768`*^9}, {3.8364683257604218`*^9, 3.836468327395061*^9}, {
   3.836468369927372*^9, 3.8364684073101788`*^9}, {3.836468480380047*^9, 
   3.836468494361*^9}, {3.836468526976097*^9, 3.83646854751446*^9}, {
   3.83646858368369*^9, 3.836468618770419*^9}, 3.8364687850778217`*^9, {
   3.8365330926256123`*^9, 3.8365331571066227`*^9}, {3.836533357379467*^9, 
   3.836533365900874*^9}, {3.836533417545143*^9, 3.836533474683916*^9}, {
   3.836534757943234*^9, 3.836534758457515*^9}, {3.836534796578947*^9, 
   3.8365348167218847`*^9}, {3.83653485721452*^9, 3.836534860008504*^9}, {
   3.836534909247314*^9, 3.836534922189179*^9}, {3.836534966800764*^9, 
   3.836535046273498*^9}, {3.8365355090508432`*^9, 3.8365355432545*^9}, {
   3.836535623051635*^9, 3.836535627143227*^9}, {3.836535756896564*^9, 
   3.8365357934497147`*^9}, {3.836535876167514*^9, 3.836535915849196*^9}, {
   3.836535947247031*^9, 3.836535952196369*^9}, {3.84707979985493*^9, 
   3.8470798159554253`*^9}, {3.8470799991865788`*^9, 3.8470801027333*^9}, {
   3.847080133758005*^9, 3.8470801476976137`*^9}, {3.847084609688108*^9, 
   3.8470846172005167`*^9}, {3.847084726987563*^9, 3.8470847272799873`*^9}, {
   3.847084759062561*^9, 3.847084788117051*^9}, {3.847084904381254*^9, 
   3.847084913764648*^9}, {3.8470864352267036`*^9, 3.847086435599468*^9}, {
   3.847086598357389*^9, 3.847086719816037*^9}, {3.847096556669188*^9, 
   3.847096556963558*^9}, {3.847096590149302*^9, 3.847096739646318*^9}, {
   3.847096816648014*^9, 3.847096936454433*^9}, {3.8470969848935633`*^9, 
   3.847097015884345*^9}, {3.847097112517445*^9, 3.847097169225628*^9}, {
   3.8470972075747633`*^9, 3.847097239742908*^9}, {3.847097378649396*^9, 
   3.8470973787627277`*^9}, {3.847097416113659*^9, 3.8470974199009867`*^9}, {
   3.847097507547778*^9, 3.847097534258424*^9}, {3.847097844574739*^9, 
   3.847097906982532*^9}, {3.84709834350607*^9, 3.8470983437977*^9}, {
   3.8470984305804043`*^9, 3.84709852514531*^9}, {3.84709855935642*^9, 
   3.847098625408596*^9}, {3.847099920908037*^9, 3.8470999255499697`*^9}, {
   3.847099978403378*^9, 3.8470999800471497`*^9}, {3.847100038333621*^9, 
   3.8471000675611134`*^9}, {3.847100344066955*^9, 3.847100373999497*^9}},
 CellLabel->
  "In[1573]:=",ExpressionUUID->"9edfc737-bdb3-4a2d-97e7-ff2733296e56"],

Cell[BoxData[
 TemplateBox[{
  "FindMinimum", "lstol", 
   "\"The line search decreased the step size to within the tolerance \
specified by AccuracyGoal and PrecisionGoal but was unable to find a \
sufficient decrease in the function. You may need more than \\!\\(\\*RowBox[{\
\\\"MachinePrecision\\\"}]\\) digits of working precision to meet these \
tolerances.\"", 2, 1576, 100, 20223779692564221389, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.847099929163823*^9, 3.847099983532737*^9, {3.8471000530876904`*^9, 
   3.847100071453023*^9}, 3.8471003474535627`*^9, 3.84710038425655*^9},
 CellLabel->
  "During evaluation of \
In[1573]:=",ExpressionUUID->"f28e23c4-e3de-456d-90f9-dbf66bfba16e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.032294571306928`*^-15", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y1", "\[Rule]", "0.4571585368673145`"}], ",", 
     RowBox[{"y2", "\[Rule]", 
      RowBox[{"-", "0.10930800930427816`"}]}], ",", 
     RowBox[{"s2", "\[Rule]", "3.8285598886636585`"}], ",", 
     RowBox[{"\[Xi]1", "\[Rule]", "0.9999483472775613`"}], ",", 
     RowBox[{"\[Xi]2", "\[Rule]", "0.999948340977864`"}], ",", 
     RowBox[{"a", "\[Rule]", "0.072589597758631`"}], ",", 
     RowBox[{"b", "\[Rule]", "4.6657878629593705`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.836382302161529*^9, {3.836382426704981*^9, 3.8363824320340853`*^9}, {
   3.8363847120884542`*^9, 3.836384756341517*^9}, 3.836384798114324*^9, {
   3.836384835802024*^9, 3.8363848694245033`*^9}, 3.836384985058819*^9, {
   3.836385030244224*^9, 3.836385035508844*^9}, {3.836385075906878*^9, 
   3.836385128518941*^9}, {3.836385168114544*^9, 3.8363851723328753`*^9}, 
   3.8363852949259233`*^9, {3.8363853273360033`*^9, 3.8363853727566442`*^9}, {
   3.8364070483380947`*^9, 3.836407054780545*^9}, {3.836407122795513*^9, 
   3.836407135660761*^9}, {3.8364071985124483`*^9, 3.8364072014908857`*^9}, 
   3.836407303132386*^9, {3.836447734785219*^9, 3.8364477907900753`*^9}, {
   3.836447849828374*^9, 3.836447914668173*^9}, {3.836448006813507*^9, 
   3.836448025778154*^9}, 3.836449161789844*^9, 3.836457722369948*^9, {
   3.836457777619986*^9, 3.836457801168249*^9}, 3.8364668132695837`*^9, 
   3.836467203710642*^9, {3.836467259586439*^9, 3.8364672738373137`*^9}, {
   3.8364675110568113`*^9, 3.8364675604230747`*^9}, {3.8364676016673822`*^9, 
   3.836467645067964*^9}, {3.836467681257058*^9, 3.836467702979321*^9}, {
   3.836467796085408*^9, 3.836467846931281*^9}, 3.836467930540578*^9, {
   3.836467970725403*^9, 3.8364679924800797`*^9}, {3.836468411377969*^9, 
   3.8364684208124313`*^9}, 3.8364684969515753`*^9, {3.836468550545126*^9, 
   3.836468555661536*^9}, 3.8364686242108583`*^9, 3.836533128738415*^9, 
   3.836533160473076*^9, 3.8365333686949787`*^9, {3.836533420403831*^9, 
   3.83653343307857*^9}, 3.836533487071492*^9, 3.8365347612892036`*^9, {
   3.8365348032999287`*^9, 3.836534819296947*^9}, {3.836535037022602*^9, 
   3.836535048774246*^9}, {3.8365355334937267`*^9, 3.836535546077713*^9}, 
   3.836535632866621*^9, 3.836535766140382*^9, 3.836535797356803*^9, {
   3.836535884150798*^9, 3.836535900802627*^9}, {3.836535945074314*^9, 
   3.836535954279168*^9}, 3.83653629007047*^9, 3.8469089097997427`*^9, 
   3.846908968291506*^9, 3.847079579091543*^9, 3.847079620846924*^9, {
   3.847079683157296*^9, 3.84707970252682*^9}, 3.847079817738928*^9, {
   3.84707986742702*^9, 3.847079876792913*^9}, {3.8470800018131123`*^9, 
   3.847080025955963*^9}, 3.847080104005436*^9, {3.847080135455731*^9, 
   3.8470801514957113`*^9}, 3.847080241470405*^9, 3.847084633275249*^9, 
   3.847084769947402*^9, 3.847084803373268*^9, {3.847084909388508*^9, 
   3.847084915063236*^9}, {3.847086429319112*^9, 3.847086436853382*^9}, {
   3.847086619581841*^9, 3.847086722295576*^9}, {3.847096559802678*^9, 
   3.847096595113204*^9}, {3.847096633653666*^9, 3.8470966624178877`*^9}, {
   3.8470968197884493`*^9, 3.847096843510261*^9}, 3.8470968838743563`*^9, {
   3.84709691763803*^9, 3.847096937942768*^9}, {3.847096990123983*^9, 
   3.847097018510817*^9}, 3.847097140721354*^9, {3.847097171888732*^9, 
   3.847097194209475*^9}, {3.8470972287538652`*^9, 3.8470972410650063`*^9}, {
   3.847097382425336*^9, 3.847097447982872*^9}, {3.847097502231414*^9, 
   3.84709753533427*^9}, {3.8470979011844797`*^9, 3.847097908417252*^9}, 
   3.847098347820745*^9, {3.8470984402282677`*^9, 3.8470985282915363`*^9}, 
   3.8470986440529003`*^9, 3.847099929177514*^9, 3.847099983542006*^9, {
   3.847100053095368*^9, 3.847100071460753*^9}, 3.847100347464007*^9, 
   3.8471003842646646`*^9},
 CellLabel->
  "Out[1576]=",ExpressionUUID->"aca7f270-c2b2-42c9-b182-3718c3b59e77"]
}, Open  ]]
},
WindowSize->{808, 663},
WindowMargins->{{107, Automatic}, {Automatic, 49}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"570e1b36-fd05-4b07-a09b-5da88d75298a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4747, 141, 388, "Input",ExpressionUUID->"dd06cdfb-210f-42cd-8419-0fb063a760b2"],
Cell[CellGroupData[{
Cell[5330, 165, 4952, 90, 115, "Input",ExpressionUUID->"9edfc737-bdb3-4a2d-97e7-ff2733296e56"],
Cell[10285, 257, 725, 14, 56, "Message",ExpressionUUID->"f28e23c4-e3de-456d-90f9-dbf66bfba16e"],
Cell[11013, 273, 3952, 61, 60, "Output",ExpressionUUID->"aca7f270-c2b2-42c9-b182-3718c3b59e77"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

